par("pch")
par('lty')
plot(airquality$Wind, airquality$Ozone, type="n")
title(main="Wind and Ozone in NYC")
may <- subset(airquality, Month==5)
?pch
points(pch=17, color="blue")
points(may,pch=17, color="blue")
points(may$Wind, may$Ozone,pch=17, col="blue")
points(may$Wind, may$Ozone, col="blue", pch=17)
notmay <- subset(airquality, Month != 5)
points(notmay$Wind, notmay$Ozone, col="red", pch=8)
legend("topright", c(17,8), c("blue", "red"), c("May", "Other Months"))
legend("topright", pch=c(17,8), col=c("blue", "red"), legend=c("May", "Other Months"))
abline(v=median(airquality$Wind), lty=2, lwd=2)
par(mfrow=c(1,2))
plot(airquality$Wind, airquality$Ozone, main="Ozone and Wind")
plot(airquality$Ozone, airquality$Solar.R, main="Ozone and Solar Radiation")
par(mfrow=c(1,3), mar=c(4,4,2,1), oma=c(0,0,2,0))
plot(airquality$Wind, airquality$Ozone, main="Ozone and Wind")
plot(airquality$Ozone, airquality$Solar.R, main="Ozone and Solar Radiation")
plot(airquality$Solar.R, airquality$Ozone, main="Ozone and Solar Radiation")
plot(airquality$Temp, airquality$Ozone, main="Ozone and Temperature")
mtext("Ozone and weather in New York City", outer=TRUE)
mtext("Ozone and Weather in New York City", outer=TRUE)
#Read inputfile
if (!file.exists("./Assignment_wk1")) {dir.create("./Assignment_wk1")}
download.file(url="https://d396qusza40orc.cloudfront.net/exdata%252Fdata%252Fhousehold_power_consumption.zip",destfile="./Assignment_wk1/HHpowerdata")
unzip("./Assignment_wk1/HHpowerdata")
library('swirl')
swirl()
head(airquality)
xyplot(Ozone ~ Wind, data=airquality)
xyplot(Ozone ~ Wind, data=airquality, col="red", pch=8, main="Big Apple Data")
xyplot(Ozone ~ Wind, data=airquality, pch=8, col="red", main="Big Apple Data")
xyplot(Ozone ~ Wind | as.factor(Month), data=airquality, layout=c(5,1))
xyplot(Ozone ~ Wind | Month, data=airquality, layout=c(5,1))
p <- xyplot(Ozone ~ Wind, data=airquality)
p
names(p)
mynames[myfull]
p[["formula"]]
p[["x.limits]]
""
""
p[["x.limits"]]
table(f)
xyplot(y~x|f, layout=c(2,1))
v1
v2
myedit("plot1.R")
myedit("plot1.R")
q
myedit("plot1.R")
0
q()
?scale
library('swirl')
swirl()
head(dataMatrix)
heatmap(dataMatrix)
"addPatt.R"
myedit("addPÃ¤tt.R")
myedit("addPatt.R")
myedit("addPatt.r")
setwd(dir='C:/Users/ntpuser3/datascience/Exploring the Data/ExploreData_Assignment2')
#1. Check if inputfiles are present and if so, read them in
if (file.exists("./summarySCC_PM25.rds")) {NEI <- readRDS("summarySCC_PM25.rds")}
if (file.exists("./Source_Classification_Code.rds")) {SCC <- readRDS("Source_Classification_Code.rds")}
#Calculate total PM2.5 emission by type and year for Baltimore City
library(dplyr)
baltimore <- subset(NEI, fips=="24510")
baltimore <- baltimore %>% mutate(year=as.factor(as.character(year)), type=as.factor(type))
#baltimore <- baltimore %>% mutate(year=as.factor(as.character(year)))
totals <- baltimore %>% group_by(year,type) %>% summarise(sum(Emissions, na.rm=TRUE))
totals <- baltimore %>% group_by(year,type) %>% summarise(sum(Emissions, na.rm=TRUE)) %>% mutate(totaal=sum(Emissions, na.rm=TRUE))
totals <- baltimore %>% group_by(year,type) %>% summarise(sum(Emissions, na.rm=TRUE)) %>% mutate(totaal='sum(Emissions, na.rm=TRUE)')
totals <- baltimore %>% group_by(year,type) %>% summarise(sum(Emissions, na.rm=TRUE))
names(totals)=c('year,'type'','totaal')
names(totals)=c('year,'type','totaal')
names(totals)=c('year','type','totaal')
library(ggplot2)
g <- ggplot(data=totals,aes(x=totals$year,y=totals$totaal),color=type)
g + theme_bw() + points(x=totals$year, y=totals$totaal, type="b")
g <- ggplot(data=totals,aes(x=totals$year,y=totals$totaal),color=type)
g
g + theme_bw() + points(x=totals$year, y=totals$totaal, type="b")
g + theme_bw() + points(x=totals$year, y=totals$totaal, pch=16)
g+theme_bw()
g+theme_bw()+points(totals$year,totals$totaal,pch=16)
g+theme_bw()+geom_point()
g+theme_bw()+geom_point(aes(color=totals$type))+xlab("year")+ylab("total PM2.5 emissions")
g+theme_bw()+geom_point(aes(color=totals$type))+facet_grid(.~totals$type)+labels(x="year", y="total PM2.5 emissions")
g+theme_bw()+geom_point(aes(color=totals$type))+facet_grid(.~totals$type)+labs(x="year", y="total PM2.5 emissions")
g+theme_bw()+geom_point()+facet_grid(.~totals$type)+labs(x="year", y="total PM2.5 emissions")
g+theme_bw()+geom_point()+facet_grid(.~type)+labs(x="year", y="total PM2.5 emissions")
totals
g+geom_point(aes(color=type))
g+geom_point(aes(color=type))+geom_line(aes(color=type))
g+geom_point(aes(color=type))+geom_line(aes(colour=type))
g+geom_point(aes(color=type))+geom_line()
g+geom_point(aes(color=type))+geom_path()
g <- ggplot(data=totals,aes(x=totals$year,y=totals$totaal),color=type, group=type)
g+geom_point()+geom_line()
g+geom_point(aes(color=type))+geom_line(aes(colour=type))
g <- ggplot(data=totals,aes(x=totals$year,y=totals$totaal,color=type, group=type)
)
g+geom_point()+geom_line()
g <- ggplot(data=totals,aes(x=totals$year,y=totals$totaal, color=type, group=type))
g+theme_bw()+geom_point()+geom_line()+labs(x="year", y="total PM2.5 emissions")
g+theme_bw()+geom_point()+geom_line()+labs(x="year", y="total PM2.5 emissions", title="With the exception of point sources, all sources decreased PM2.5 emission")
png(filename="plot3.png", width=580, height=580)
library(ggplot2)
g <- ggplot(data=totals,aes(x=totals$year,y=totals$totaal, color=type, group=type))
g+theme_bw()+geom_point()+geom_line()+labs(x="year", y="total PM2.5 emissions", title="With the exception of point sources, all sources decreased PM2.5 emission")
dev.off()
g+facet_grid(.~type)+geom_point()
a <- arrange(totals,type, year)
a <- arrange(totals,totals$type, totals$year)
a
g+facet_grid(.~type)+geom_point()
library(datasets)
head(cars)
datasets$
)
library(help="datasets")
heads(women)
head(women)
head(sleep)
head(swiss)
head(cars)
head(trees)
head(crimtab)
head(swiss)
head(mpg)
mpg <- mpg %>% mutate(year=as.factor(year), trans=as.factor(trans),manufacturer=as.factor(manufacturer))
str(mpg)
gem <- mpg %>% group_by(manufacturer,year,trans) %>% summarise(displ,mean)
gem
gem <- mpg %>% group_by(manufacturer,year,trans) %>% summarise(gemid=mean(displ))
gem
gem <- mpg %>% group_by(manufacturer,year) %>% summarise(gemid=mean(displ))
gem
q <- qqplot(gem,aes(x=year,y=gemid,group=manufacturer))
q + facet_grid(.~manufacturer) + geom_points()
p <- ggplot(mpg,aes(displ,cty)) + geom_point()
p + facet_grid(drv ~.)
a <- ggplot(totals,aes(totals$year, totals$totaal))+geom_point()
a
a + facet_grid(.~totals$type)
a + facet_grid(.~type)
a <- ggplot(totals,aes(year, totaal))+geom_point()
a + facet_grid(.~type)
g + theme_bw()+facet_grid(.~type)+geom_point()+geom_line()+labs(x="year", y="total PM2.5 emissions", title="With the exception of point sources, all sources decreased PM2.5 emission")
g <- ggplot(data=totals,aes(x=year,y=totaal))
g + theme_bw()+facet_grid(.~type)+geom_point()+geom_line()+labs(x="year", y="total PM2.5 emissions", title="With the exception of point sources, all sources decreased PM2.5 emission")
g <- ggplot(data=totals,aes(x=year,y=totaal,group=type))
g + theme_bw()+facet_grid(.~type)+geom_point()+geom_line()+labs(x="year", y="total PM2.5 emissions", title="With the exception of point sources, all sources decreased PM2.5 emission")
png(filename="plot3.png", width=580, height=580)
library(ggplot2)
g <- ggplot(data=totals,aes(x=year,y=totaal, group=type))
g + theme_bw()+facet_grid(.~type)+geom_point()+geom_line()+labs(x="year", y="total PM2.5 emissions", title="With the exception of point sources, all sources decreased PM2.5 emission")
#Alternative code with coloured timelines in one plot
#g <- ggplot(data=totals,aes(x=totals$year,y=totals$totaal, color=type, group=type))
#g+theme_bw()+geom_point()+geom_line()+labs(x="year", y="total PM2.5 emissions", title="With the exception of point sources, all sources decreased PM2.5 emission")
dev.off()
head(SCC)
str(scc)
str(SCC)
unique(SCC$Short.Name)
a <- grepl("coal combustion",SCC$Short.Name)
sum(a)
a <- grepl("combustion",SCC$Short.Name)
sum(a)
a
SCC[a,Short.Name]
SCC[a,SCC$Short.Name]
SCC[a,2]
str(SCC)
SCC[a,3]
a <- grepl("coal",SCC$Short.Name)
SCC[a,3]
a <- grepl("comb",SCC$Short.Name)
sum(a)
SCC[a,3]
head(SCC,1)
str(SCC)
a <- grepl("coal" & comb",SCC$Short.Name)
)
)
""
a <- grepl("coal" & "comb",SCC$Short.Name)
a <- grepl(comb",SCC$Short.Name)
""
a <- grepl("comb",SCC$Short.Name)
b <- SCC[a,3]
b
head(SCC,1)
a <- grepl("comb",lower(SCC$Short.Name)
)
a <- grepl("comb",tolower(SCC$Short.Name)
)
a
b <- SCC[a,3]
b
a <- grepl("coal",tolower(SCC$Short.Name))
b <- SCC[a,3]
c <- grepl("comb",tolower(b))
coal_comb <- b[c]
coal_comb
sum(coal_comb)
nrow(coal_comb)
length(coal_comb)
str(SCC)
a <- grepl("coal",tolower(SCC$Short.Name))
b <- SCC[a,c(1,3)]
c <- grepl("comb",tolower(b[,2]))
coal_comb <- b[c,]
nrow(coal_comb)
head(coal_comb)
str(NEI)
coal_comb_sel <- subset(NEI,NEI$SCC %in% coal_comb[,1])
str(coal_comb_sel)
unique(coal_comb_sel$SCC)
sum(unique(coal_comb_sel$SCC))
count(unique(coal_comb_sel$SCC)))
count(unique(coal_comb_sel$SCC))
length(unique(coal_comb_sel$SCC))
head(coal_comb,10)
totals <- coal_comb_sel %>% mutate(year=as.factor(year)) %>% group_by(year) %>% summarise(sum(Emissions))
totals
names(totals) <- c("year","emission")
g <- ggplot(totals, aes(x=levels(year),y=emission)
g <- ggplot(totals, aes(x=levels(year),y=emission))
g
g <- ggplot(totals, aes(x=levels(year),y=emission))
g + geom_bar()
g + geom_point()
g + geom_bar(stat="identity")
g + geom_bar(stat="identity")+theme_bw()
g <- ggplot(totals, aes(x=levels(year),y=emission/1000))
om_bar(stat="identity")+theme_bw()+labs(x="year",y="total PM2.5 emission (in K tons)")
g+geom_bar(stat="identity")+theme_bw()+labs(x="year",y="total PM2.5 emission (in K tons)")
g + geom_bar(stat="identity")+theme_bw()+labs(x="year",y="total PM2.5 emission (in K tons)",title="Total PM2.5 emission from coal combustion related sources declined with 40% between 1999 and 2008")+geom_text(label=emission)
g + geom_bar(stat="identity")+theme_bw()+labs(x="year",y="total PM2.5 emission (in K tons)",title="Total PM2.5 emission from coal combustion related sources declined with 40% between 1999 and 2008")+geom_text()
g + geom_bar(stat="identity")+theme_bw()+labs(x="year",y="total PM2.5 emission (in K tons)",title="Total PM2.5 emission from coal combustion related sources declined with 40% between 1999 and 2008")+geom_text(aes(label=emission))
g + geom_bar(stat="identity",aes(colour="red"))+theme_bw()+labs(x="year",y="total PM2.5 emission (in K tons)",title="Total PM2.5 emission from coal combustion related sources declined with 40% between 1999 and 2008")+geom_text(aes(label=round(emission/1000,1))
)4
g + geom_bar(stat="identity",aes(colour="red"))+theme_bw()+labs(x="year",y="total PM2.5 emission (in K tons)",title="Total PM2.5 emission from coal combustion related sources declined with 40% between 1999 and 2008")+geom_text(aes(label=round(emission/1000,1)))
g + geom_bar(stat="identity",aes(fill="red"))+theme_bw()+labs(x="year",y="total PM2.5 emission (in K tons)",title="Total PM2.5 emission from coal combustion related sources declined with 40% between 1999 and 2008")+geom_text(aes(label=round(emission/1000,1)))
g <- ggplot(totals, aes(x=levels(year),y=emission/1000))
g <- g + geom_bar(stat="identity",aes(fill="red"),guide=FALSE)+theme_bw()
g <- g+labs(x="year",y="total PM2.5 emission (in K tons)",title="Total PM2.5 emission from coal combustion related sources declined with 40% between 1999 and 2008")
g+geom_text(aes(label=round(emission/1000,1)))
g <- ggplot(totals, aes(x=levels(year),y=emission/1000))
g2 <- g + geom_bar(stat="identity",aes(fill="red"),guide=FALSE)+theme_bw()
g <- ggplot(totals, aes(x=levels(year),y=emission/1000))
g <- g + geom_bar(stat="identity",aes(fill="red"),show.legend=NA)+theme_bw()
g
g <- g+labs(x="year",y="total PM2.5 emission (in K tons)",title="Total PM2.5 emission from coal combustion related sources declined with 40% between 1999 and 2008")
g+geom_text(aes(label=round(emission/1000,1)))
g <- ggplot(totals, aes(x=levels(year),y=emission/1000))
g <- g + geom_bar(stat="identity",aes(fill="red", guide=FALSE),show.legend=NA)+theme_bw()
g
g <- ggplot(totals, aes(x=levels(year),y=emission/1000))
g <- g + geom_bar(stat="identity",aes(fill="red")+theme_bw()+guides(fill=FALSE)
)
g <- ggplot(totals, aes(x=levels(year),y=emission/1000))
g <- g + geom_bar(stat="identity",aes(fill="red"))+theme_bw()+guides(fill=FALSE)
g
g <- g+labs(x="year",y="total PM2.5 emission (in K tons)",title="Total PM2.5 emission from coal combustion related sources declined with 40% between 1999 and 2008")
g+geom_text(aes(label=round(emission/1000,1)))
g <- ggplot(totals, aes(x=levels(year),y=emission/1000))
g <- g + geom_bar(stat="identity",aes(fill="red"))+theme_bw()+guides(fill=FALSE)
g <- g+labs(x="year",y="total PM2.5 emission (in K tons)",title="Total PM2.5 emission from coal combustion related sources declined with 40% between 1999 and 2008")
g+geom_text(aes(label=round(emission/1000,1), size=4, hjust=0.5))
g+geom_text(aes(label=round(emission/1000,1), size=4, hjust=1))
g+geom_text(aes(label=round(emission/1000,1), size=3, hjust=0.5, vjust=1))
g+geom_text(aes(label=round(emission/1000,1), size=3, hjust=0.5, vjust=0.5))
g+geom_text(aes(label=round(emission/1000,1), size=3, hjust=0.5, vjust=1.5))
g <- ggplot(totals, aes(x=levels(year),y=emission/1000))
g <- g + geom_bar(stat="identity",aes(fill="red"))+theme_bw()
g <- g+labs(x="year",y="total PM2.5 emission (in K tons)",title="After three rather stable years, total PM2.5 emission from coal combustion related sources declined with 40% between 1999 and 2008")
g+geom_text(aes(label=round(emission/1000,1), size=3, hjust=0.5, vjust=1.5))+guides(fill=FALSE, text=FALSE)
par(cex.main=0.8)
g <- ggplot(totals, aes(x=levels(year),y=emission/1000))
g <- g + geom_bar(stat="identity",aes(fill="red"))+theme_bw()
g <- g+labs(x="year",y="total PM2.5 emission (in K tons)",title="After three rather stable years, total PM2.5 emission from coal combustion related sources declined with 40% between 1999 and 2008")
g+geom_text(aes(label=round(emission/1000,1), size=3, hjust=0.5, vjust=1.5))+guides(fill=FALSE, text=FALSE)
g <- ggplot(totals, aes(x=levels(year),y=emission/1000))
g <- g + geom_bar(stat="identity",aes(fill="red"))+theme_bw(plot.title=element_text(size=12))
g <- g + geom_bar(stat="identity",aes(fill="red"))+theme(plot.title=element_text(size=12))
g
g <- g + geom_bar(stat="identity",aes(fill="red"))+theme(plot.title=element_text(size=12),plot.background=element_rect(fill="white"))
g
g + geom_bar(stat="identity",aes(fill="red"))+theme(plot.title=element_text(size=12),plot.background=element_rect())
g + geom_bar(stat="identity",aes(fill="red"))+theme(plot.title=element_text(size=12),plot.background=element_rect(fill="white"))
g + geom_bar(stat="identity",aes(fill="red"))+theme(plot.title=element_text(size=12),plot.background=element_blank()))
g + geom_bar(stat="identity",aes(fill="red"))+theme(plot.title=element_text(size=12),plot.background=element_blank())
g + geom_bar(stat="identity",aes(fill="red"))+theme(plot.title=element_text(size=12),plot.background=element_blank(),panel.background=element_blank())
g <- ggplot(totals, aes(x=levels(year),y=emission/1000))
g <- g + geom_bar(stat="identity",aes(fill="red"))+theme_bw()
g <- g+labs(x="year",y="total PM2.5 emission (in K tons)",title="After 3 rather stable years, total PM2.5 emission from coal combustion declined with 40% between 1999 and 2008")
g+geom_text(aes(label=round(emission/1000,1), size=3, hjust=0.5, vjust=1.5))+guides(fill=FALSE, text=FALSE)
g+guides(size=FALSE)
g+guides(size=FALSE,fill=FALSE)
g <- ggplot(totals, aes(x=levels(year),y=emission/1000))
g <- g + geom_bar(stat="identity",aes(fill="red"))+theme_bw()
g <- g+labs(x="year",y="total PM2.5 emission (in K tons)",title="After 3 rather stable years, total PM2.5 emission from coal combustion declined with 40% between 1999 and 2008")
g+geom_text(aes(label=round(emission/1000,1), size=3, hjust=0.5, vjust=1.5))+guides(fill=FALSE, size=FALSE)
png(filename="plot4.png", width=580, height=580)
g <- ggplot(totals, aes(x=levels(year),y=emission/1000))
g <- g + geom_bar(stat="identity",aes(fill="red"))+theme_bw()
g <- g+labs(x="year",y="total PM2.5 emission (in K tons)",title="After 3 rather stable years, total PM2.5 emission from coal combustion declined with 40% between 1999 and 2008")
g+geom_text(aes(label=round(emission/1000,1), size=3, hjust=0.5, vjust=1.5))+guides(fill=FALSE, size=FALSE)
dev.off()
png(filename="plot4.png", width=750, height=750)
g <- ggplot(totals, aes(x=levels(year),y=emission/1000))
g <- g + geom_bar(stat="identity",aes(fill="red"))+theme_bw()
g <- g+labs(x="year",y="total PM2.5 emission (in K tons)",title="After 3 rather stable years, total PM2.5 emission from coal combustion declined with 40% between 1999 and 2008")
g+geom_text(aes(label=round(emission/1000,1), size=3, hjust=0.5, vjust=1.5))+guides(fill=FALSE, size=FALSE)
dev.off()
png(filename="plot4.png", width=775, height=775)
g <- ggplot(totals, aes(x=levels(year),y=emission/1000))
g <- g + geom_bar(stat="identity",aes(fill="red"))+theme_bw()
g <- g+labs(x="year",y="total PM2.5 emission (in K tons)",title="After 3 rather stable years, total PM2.5 emission from coal combustion declined with 40% between 1999 and 2008")
g+geom_text(aes(label=round(emission/1000,1), size=3, hjust=0.5, vjust=1.5))+guides(fill=FALSE, size=FALSE)
dev.off()
#Select motor vehicle emission sources from Baltimore City
a <- grepl("motor",tolower(SCC$Short.Name))
sum(a)
head(a,10)
b <- SCC[a,c(1,3)]
head(b,10)
unique(b)
unique(b)
length(unique(b))
nrow(unique(b))
motor_sel <- subset(NEI,NEI$SCC %in% motor[,1] & fips="24510")
motor_sel <- subset(NEI,NEI$SCC %in% motor[,1] && fips="24510")
motor_sel <- subset(NEI,NEI$SCC %in% motor[,1] and fips="24510")
motor_sel <- subset(NEI,NEI$SCC %in% motor[,1] & fips=="24510")
a <- grepl("motor",tolower(SCC$Short.Name))
b <- SCC[a,c(1,3)]
motor <- b[c,]  #138 sources
motor_sel <- subset(NEI,NEI$SCC %in% motor[,1] & fips=="24510") #in Baltimore only 76 of these occur
unique(motor_sel$fips)
length(unique(motor_sel$SCC))
totals <- motor_sel %>% mutate(year=as.factor(year)) %>% group_by(year) %>% summarise(sum(Emissions))
totals
motor_sel <- motor_sel %>% mutate(year=as.factor(year))
boxplot(motor_sel,Emissions~year)
motor_sel <- subset(NEI,NEI$SCC %in% motor[,1] & fips=="24510") #in Baltimore only 24 of these occur
boxplot(motor_sel,Emissions~year)
boxplot(data=motor_sel,motor_sel$Emissions~motor_sel$year)
motor_sel %>% group_by(motor_sel$year) %>% summarise(max(motor_sel$Emissions))
motor_sel %>% group_by(year) %>% summarise(max(Emissions))
motor_sel %>% group_by(year) %>% summarise(median(Emissions))
motor_sel %>% group_by(year) %>% summarise(n(Emissions))
motor_sel %>% group_by(year) %>% summarise(n())
boxplot(data=motor_sel,motor_sel$Emissions~motor_sel$year,main="After an initial strong decline, the median PM2.5 emission returned in 2008 nearly to its 1999-level", xlab="year", ylab="PM2.5 emission (tons)")
boxplot(data=motor_sel,motor_sel$Emissions~motor_sel*1000$year,main="After an initial strong decline, in 2008 the median PM2.5 emission nearly returned to its 1999-level", xlab="year", ylab="PM2.5 emission (tons)")
boxplot(data=motor_sel,motor_sel$Emissions*1000~motor_sel$year,main="After an initial strong decline, in 2008 the median PM2.5 emission nearly returned to its 1999-level", xlab="year", ylab="PM2.5 emission (tons)")
boxplot(data=motor_sel,motor_sel$Emissions~motor_sel$year,main="After an initial strong decline, in 2008 the median PM2.5 emission nearly returned to its 1999-level", xlab="year", ylab="PM2.5 emission (tons)")
motor_sel_base <- subset(motor_sel,year==1999)
abline(h=median(motor_sel_base$Emissions))
abline(h=median(motor_sel_base$Emissions),col='red', lwd=2)
abline(h=median(motor_sel_base$Emissions),col='red', lwd=2, lty=2)
boxplot(data=motor_sel,motor_sel$Emissions~motor_sel$year,main="After an initial strong decline, in 2008 the median PM2.5 emission nearly returned to its 1999-level", xlab="year", ylab="PM2.5 emission (tons)")
abline(h=median(motor_sel_base$Emissions),col='red', lwd=2, lty=2)
png(filename="plot5.png",height=480,width=480)
boxplot(data=motor_sel,motor_sel$Emissions~motor_sel$year,main="After an initial strong decline, in 2008 the median PM2.5 emission nearly returned to its 1999-level", xlab="year", ylab="PM2.5 emission (tons)")
abline(h=median(motor_sel_base$Emissions),col='red', lwd=2, lty=2)
dev.off()
png(filename="plot5.png",height=600,width=600)
boxplot(data=motor_sel,motor_sel$Emissions~motor_sel$year,main="After an initial strong decline, in 2008 the median PM2.5 emission nearly returned to its 1999-level", xlab="year", ylab="PM2.5 emission (tons)")
abline(h=median(motor_sel_base$Emissions),col='red', lwd=2, lty=2)
dev.off()
png(filename="plot5.png",height=600,width=600)
par(cex.main=0.9)
boxplot(data=motor_sel,motor_sel$Emissions~motor_sel$year,main="After an initial strong decline, in 2008 the median PM2.5 emission nearly returned to its 1999-level", xlab="year", ylab="PM2.5 emission (tons)")
abline(h=median(motor_sel_base$Emissions),col='red', lwd=2, lty=2)
dev.off()
a <- grepl("motor",tolower(SCC$Short.Name))
b <- SCC[a,c(1,3)]
motor <- b[c,]  #138 sources
motor_sel_balti <- subset(NEI,NEI$SCC %in% motor[,1] & fips=="24510") #in Baltimore only 24 of these occur
motor_sel_la <- subset(NEI,NEI$SCC %in% motor[,1] & fips=="06037")
length(unique(motor_sel_la$SCC))
totals_balti <- motor_sel_balti %>% mutate(year=as.factor(year)) %>% group_by(year) %>% summarise(sum(Emissions,na.rm=TRUE))
totals_la <- motor_sel_la %>% mutate(year=as.factor(year)) %>% group_by(year) %>% summarise(sum(Emissions,na.rm=TRUE))
totals_balti
totals_la
names(totals_balti) <- c('year','totaal')
names(totals_la) <- c('year','totaal')
with(totals_balti,plot(levels(year),totaal,xlab='year',ylab='PM2.5 emission motor vechicles (in tons)', ylim=c(0,16)))
with(totals_la,points(levels(year),totaal),col="red")
with(totals_balti,plot(levels(year),totaal,pch=16, xlab='year',ylab='PM2.5 emission motor vechicles (in tons)', ylim=c(0,16)))
with(totals_la,points(levels(year),totaal),pch=17, col='red')
with(totals_la,points(levels(year),totaal,pch=17, col='red')
)
with(totals_balti,plot(levels(year),totaal,pch=16, xlab='year',ylab='PM2.5 emission motor vechicles (in tons)', ylim=c(0,16)))
with(totals_la,points(levels(year),totaal,pch=17, col='red'))
with(totals_balti,plot(levels(year),totaal,pch=16, type="b", xlab='year',ylab='PM2.5 emission motor vechicles (in tons)', ylim=c(0,16)))
with(totals_la,lines(levels(year),totaal,pch=17, col='red'))
with(totals_balti,plot(levels(year),totaal,pch=16, type="l", xlab='year',ylab='PM2.5 emission motor vechicles (in tons)', ylim=c(0,16)))
with(totals_la,lines(levels(year),totaal,pch=17, col='red'))
title(main="While PM2.5 emission by motor cycles remained stable in Baltimore, it keeps on increasing in LA")
legend(x="bottom",legend=c("LA", "Baltimore City"),col=("red","black"))
legend(x="bottom",legend=c("LA", "Baltimore City"),col=c("red","black"))
legend(x="right",legend=c("LA", "Baltimore City"),col=c("red","black"),lty=1)
with(totals_balti,plot(levels(year),totaal,pch=16, type="l", xlab='year',ylab='PM2.5 emission motor vechicles (in tons)', ylim=c(0,16)))
with(totals_la,lines(levels(year),totaal,pch=17, col='red'))
title(main="While PM2.5 emission by motor cycles remained stable in Baltimore, it keeps on increasing in LA")
legend(x="right",legend=c("LA", "Baltimore City"),col=c("red","black"),lty=1)
text(levels(totals_balti$year),totaal, labels=round(totaal,1), cex=0.9, pos=3)
text(levels(totals_balti$year),totals_balti$totaal, labels=round(totaal,1), cex=0.9, pos=3)
totals_balti$totaal
text(levels(totals_balti$year),totals_balti$totaal, labels=round(totals_balti$totaal,1), cex=0.9, pos=3)
with(totals_balti,plot(levels(year),totaal,pch=16, type="l", xlab='year',ylab='PM2.5 emission motor vechicles (in tons)', ylim=c(0,16)))
with(totals_la,lines(levels(year),totaal,pch=17, col='red'))
title(main="While PM2.5 emission by motor cycles remained stable in Baltimore, it keeps on increasing in LA")
legend(x="right",legend=c("LA", "Baltimore City"),col=c("red","black"),lty=1)
text(levels(totals_balti$year),totals_balti$totaal, labels=round(totals_balti$totaal,2), cex=0.9, pos=3)
text(levels(totals_la$year),totals_la$totaal, labels=round(totals_la$totaal,2), cex=0.9, pos=3)
text(levels(totals_balti$year),totals_balti$totaal, labels=round(totals_balti$totaal,1), cex=0.9, pos=3)
text(levels(totals_balti$year),totals_balti$totaal, labels=round(totals_balti$totaal,1), cex=0.9, pos=)
text(levels(totals_balti$year),totals_balti$totaal, labels=round(totals_balti$totaal,1), cex=0.9, pos=1)
with(totals_balti,plot(levels(year),totaal,pch=16, type="l", xlab='year',ylab='PM2.5 emission motor vechicles (in tons)', ylim=c(0,16)))
with(totals_la,lines(levels(year),totaal,pch=17, col='red'))
title(main="While PM2.5 emission by motor cycles remained stable in Baltimore, it keeps on increasing in LA")
legend(x="right",legend=c("LA", "Baltimore City"),col=c("red","black"),lty=1)
text(levels(totals_balti$year),totals_balti$totaal, labels=round(totals_balti$totaal,2), cex=0.9, pos=1)
text(levels(totals_la$year),totals_la$totaal, labels=round(totals_la$totaal,2), cex=0.9, pos=1)
with(totals_balti,plot(levels(year),totaal,pch=16, type="l", xlab='year',ylab='PM2.5 emission motor vechicles (in tons)', ylim=c(0,16)))
with(totals_la,lines(levels(year),totaal,pch=17, col='red'))
title(main="While PM2.5 emission by motor cycles remained stable in Baltimore, it keeps on increasing in LA")
legend(x="right",legend=c("LA", "Baltimore City"),col=c("red","black"),lty=1)
text(levels(totals_balti$year),totals_balti$totaal, labels=round(totals_balti$totaal,2), cex=0.9, pos=3)
text(levels(totals_la$year),totals_la$totaal, labels=round(totals_la$totaal,2), cex=0.9, pos=1)
with(totals_balti,plot(levels(year),totaal,pch=16, type="l", xaxt='n',xlab='year',ylab='PM2.5 emission motor vechicles (in tons)', ylim=c(0,16)))
with(totals_la,lines(levels(year),totaal,pch=17, col='red'))
title(main="While PM2.5 emission by motor cycles remained stable in Baltimore, it nearly tripled in LA between 1999 and 2008")
axis(side=1,labels=levels(totals_baltimore$year) ,at=seq(1999, 2008, by=3))
legend(x="right",legend=c("LA", "Baltimore City"),col=c("red","black"),lty=1)
text(levels(totals_balti$year),totals_balti$totaal, labels=round(totals_balti$totaal,2), cex=0.9, pos=3)
text(levels(totals_la$year),totals_la$totaal, labels=round(totals_la$totaal,2), cex=0.9, pos=1)
with(totals_balti,plot(levels(year),totaal,pch=16, type="l", xaxt='n',xlab='year',ylab='PM2.5 emission motor vechicles (in tons)', ylim=c(0,16)))
with(totals_la,lines(levels(year),totaal,pch=17, col='red'))
title(main="While PM2.5 emission by motor cycles remained stable in Baltimore, it nearly tripled in LA between 1999 and 2008")
axis(side=1,labels=levels(totals_balti$year) ,at=seq(1999, 2008, by=3))
legend(x="right",legend=c("LA", "Baltimore City"),col=c("red","black"),lty=1)
text(levels(totals_balti$year),totals_balti$totaal, labels=round(totals_balti$totaal,2), cex=0.9, pos=3)
text(levels(totals_la$year),totals_la$totaal, labels=round(totals_la$totaal,2), cex=0.9, pos=1)
par(cex.lab=0.9,cex.main=0.9)
with(totals_balti,plot(levels(year),totaal,pch=16, type="l", xaxt='n',xlab='year',ylab='PM2.5 emission motor vechicles (in tons)', ylim=c(0,16)))
with(totals_la,lines(levels(year),totaal,pch=17, col='red'))
title(main="While PM2.5 emission by motor cycles remained stable in Baltimore, it nearly tripled in LA between 1999 and 2008")
axis(side=1,labels=levels(totals_balti$year) ,at=seq(1999, 2008, by=3))
legend(x="right",legend=c("LA", "Baltimore City"),col=c("red","black"),lty=1)
text(levels(totals_balti$year),totals_balti$totaal, labels=round(totals_balti$totaal,2), cex=0.9, pos=3)
text(levels(totals_la$year),totals_la$totaal, labels=round(totals_la$totaal,2), cex=0.9, pos=1)
png(filename="plot6.png",height=480, width=480)
par(cex.lab=0.9,cex.main=0.9)
with(totals_balti,plot(levels(year),totaal,pch=16, type="l", xaxt='n',xlab='year',ylab='PM2.5 emission motor vechicles (in tons)', ylim=c(0,16)))
with(totals_la,lines(levels(year),totaal,pch=17, col='red'))
title(main="While PM2.5 emission by motor cycles remained stable in Baltimore, it nearly tripled in LA between 1999 and 2008")
axis(side=1,labels=levels(totals_balti$year) ,at=seq(1999, 2008, by=3))
legend(x="right",legend=c("LA", "Baltimore City"),col=c("red","black"),lty=1)
text(levels(totals_balti$year),totals_balti$totaal, labels=round(totals_balti$totaal,2), cex=0.9, pos=3)
text(levels(totals_la$year),totals_la$totaal, labels=round(totals_la$totaal,2), cex=0.9, pos=1)
dev.off()
png(filename="plot6.png",height=600, width=600)
par(cex.lab=0.9,cex.main=0.9)
with(totals_balti,plot(levels(year),totaal,pch=16, type="l", xaxt='n',xlab='year',ylab='PM2.5 emission motor vechicles (in tons)', ylim=c(0,16)))
with(totals_la,lines(levels(year),totaal,pch=17, col='red'))
title(main="While PM2.5 emission by motor cycles remained stable in Baltimore, it nearly tripled in LA between 1999 and 2008")
axis(side=1,labels=levels(totals_balti$year) ,at=seq(1999, 2008, by=3))
legend(x="right",legend=c("LA", "Baltimore City"),col=c("red","black"),lty=1)
text(levels(totals_balti$year),totals_balti$totaal, labels=round(totals_balti$totaal,2), cex=0.9, pos=3)
text(levels(totals_la$year),totals_la$totaal, labels=round(totals_la$totaal,2), cex=0.9, pos=1)
dev.off()
png(filename="plot6.png",height=750, width=750)
par(cex.lab=0.9,cex.main=0.9)
with(totals_balti,plot(levels(year),totaal,pch=16, type="l", xaxt='n',xlab='year',ylab='PM2.5 emission motor vechicles (in tons)', ylim=c(0,16)))
with(totals_la,lines(levels(year),totaal,pch=17, col='red'))
title(main="While PM2.5 emission by motor cycles remained stable in Baltimore, it nearly tripled in LA between 1999 and 2008")
axis(side=1,labels=levels(totals_balti$year) ,at=seq(1999, 2008, by=3))
legend(x="right",legend=c("LA", "Baltimore City"),col=c("red","black"),lty=1)
text(levels(totals_balti$year),totals_balti$totaal, labels=round(totals_balti$totaal,2), cex=0.9, pos=3)
text(levels(totals_la$year),totals_la$totaal, labels=round(totals_la$totaal,2), cex=0.9, pos=1)
dev.off()
png(filename="plot6.png",height=750, width=750)
par(cex.lab=0.9)
with(totals_balti,plot(levels(year),totaal,pch=16, type="l", xaxt='n',xlab='year',ylab='PM2.5 emission motor vechicles (in tons)', ylim=c(0,16)))
with(totals_la,lines(levels(year),totaal,pch=17, col='red'))
title(main="While PM2.5 emission by motor cycles remained stable in Baltimore, it nearly tripled in LA between 1999 and 2008")
axis(side=1,labels=levels(totals_balti$year) ,at=seq(1999, 2008, by=3))
legend(x="right",legend=c("LA", "Baltimore City"),col=c("red","black"),lty=1)
text(levels(totals_balti$year),totals_balti$totaal, labels=round(totals_balti$totaal,2), cex=0.9, pos=3)
text(levels(totals_la$year),totals_la$totaal, labels=round(totals_la$totaal,2), cex=0.9, pos=1)
dev.off()
png(filename="plot6.png",height=750, width=750)
par(cex.lab=0.9,cex.main=0.95)
with(totals_balti,plot(levels(year),totaal,pch=16, type="l", xaxt='n',xlab='year',ylab='PM2.5 emission motor vechicles (in tons)', ylim=c(0,16)))
with(totals_la,lines(levels(year),totaal,pch=17, col='red'))
title(main="While PM2.5 emission by motor cycles remained stable in Baltimore, it nearly tripled in LA between 1999 and 2008")
axis(side=1,labels=levels(totals_balti$year) ,at=seq(1999, 2008, by=3))
legend(x="right",legend=c("LA", "Baltimore City"),col=c("red","black"),lty=1)
text(levels(totals_balti$year),totals_balti$totaal, labels=round(totals_balti$totaal,2), cex=0.9, pos=3)
text(levels(totals_la$year),totals_la$totaal, labels=round(totals_la$totaal,2), cex=0.9, pos=1)
dev.off()
